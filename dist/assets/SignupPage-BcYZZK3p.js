import{j as e}from"./spline-C1bWgT9i.js";import{r as t,u as s,c as r}from"./react-vendor-D-1Z2fag.js";import{S as a,a as n}from"./index-BH9g96JM.js";import"./supabase-Dexhd8Ad.js";function l(){const[l,o]=t.useState(""),[i,c]=t.useState(!0),[d,u]=t.useState("email"),[m,x]=t.useState(["","","","","",""]),[p,h]=t.useState(""),[f,g]=t.useState(!1),[v,w]=t.useState(""),[b,y]=t.useState(null),[j,N]=t.useState(!1),[k,S]=t.useState(window.innerWidth<640),[E,C]=t.useState(!1),[F,T]=t.useState(!1),B=s(),[z]=r(),P=t.useRef([]);t.useEffect(()=>{const e=setTimeout(()=>{N(!0)},100);return()=>clearTimeout(e)},[]),t.useEffect(()=>{const e=()=>S(window.innerWidth<640);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),t.useEffect(()=>{if("artist"===z.get("source"))C(!0),localStorage.setItem("signupSource","artist");else{const e=localStorage.getItem("signupSource"),t=sessionStorage.getItem("signupSource");"artist"!==e&&"artist"!==t||C(!0)}},[z]),t.useEffect(()=>{"code"===d&&setTimeout(()=>{var e;null==(e=P.current[0])||e.focus()},100)},[d]);const I=async()=>{if(l&&i){g(!0),h("");try{const e=`${a}/functions/v1/send-otp`,t=await fetch(e,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({email:l,isSignup:!0})}),s=await t.json();if(!s.success)throw new Error(s.message);s.isContinuation&&T(!0),s.emailSent?(w(""),y(null)):(s.emailError?w(`Email service error: ${s.emailError}. Please check your email configuration.`):w("Email service is not configured. OTP code will be shown below for testing."),s.devCode),u("code")}catch(e){h(e.message||"Failed to send verification code")}finally{g(!1)}}},O=async e=>{g(!0),h("");try{const s=`${a}/functions/v1/verify-otp`,r=await fetch(s,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({email:l,code:e,isSignup:!0})});if(!r.ok){const e=await r.text();let s="Failed to verify OTP";try{const t=JSON.parse(e);s=t.message||t.error||s}catch(t){s=e||`Server error (${r.status})`}throw new Error(s)}const o=await r.json();if(!o.success)throw new Error(o.message||"Invalid verification code");if(!o.userId)throw new Error(o.message||"User ID not received from server. Please try again or contact support.");localStorage.setItem("verifiedEmail",l),localStorage.setItem("verifiedUserId",o.userId),E?(localStorage.removeItem("signupSource"),B("/make-profile",{state:{userType:"artist"}})):B("/make-profile")}catch(s){const e=s.message||s.toString()||"Failed to verify OTP. Please try again.";h(e),x(["","","","","",""]),setTimeout(()=>{var e;null==(e=P.current[0])||e.focus()},50)}finally{g(!1)}},$=async()=>{g(!0),h("");try{const e=`${a}/functions/v1/send-otp`,t=await fetch(e,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({email:l,isSignup:!0})}),s=await t.json();if(!s.success)throw new Error(s.message);s.emailSent?(w(""),y(null)):(s.emailError?w(`Email service error: ${s.emailError}. Please check your email configuration.`):w("Email service is not configured. OTP code will be shown below for testing."),s.devCode)}catch(e){h("Failed to resend code")}finally{g(!1)}};return"code"===d?e.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center relative overflow-hidden py-8 sm:py-12 px-6",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E\")"},children:[e.jsxs("button",{onClick:()=>B(E?"/learn/artist":"/"),className:"fixed top-6 left-6 z-50 flex items-center gap-1.5 text-gray-400 hover:text-white transition-colors group",children:[e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-xs font-medium",children:E?"Back":"Home"})]}),!k&&e.jsx("div",{className:"absolute inset-0 w-full h-full pointer-events-none transition-opacity duration-700 ease-out overflow-hidden",style:{opacity:j?1:0,transform:"translateX(30%) scale(1.035)"},children:e.jsx("spline-viewer",{url:"https://prod.spline.design/hxB6DGH8u6Rcpq21/scene.splinecode","mouse-controls":"false",className:"spline-viewer-no-watermark"})}),e.jsxs("div",{className:"relative z-10 w-full max-w-sm flex flex-col items-center",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-white mb-2",children:"We emailed you a code"}),e.jsx("p",{className:"text-neutral-400 text-sm",children:"Enter the verification code sent to"}),e.jsxs("p",{className:"text-neutral-400 text-sm",children:[e.jsx("span",{className:"text-white break-all",children:l})," ",e.jsx("button",{onClick:()=>{u("email"),w(""),y(null)},className:"text-white font-medium hover:text-neutral-300 transition-colors",children:"Ã—"})]})]}),e.jsx("div",{className:"w-full p-6 relative overflow-hidden",style:{background:"rgba(10, 10, 15, 0.65)",backdropFilter:"blur(24px)",WebkitBackdropFilter:"blur(24px)",border:"1px solid rgba(255, 255, 255, 0.06)",borderRadius:"16px",boxShadow:"0 24px 48px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.03)"},children:e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsx("div",{className:"flex justify-center gap-2",children:m.map((t,s)=>e.jsx("input",{ref:e=>P.current[s]=e,type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:e=>((e,t)=>{var s;if(!/^\d*$/.test(t))return;const r=[...m];r[e]=t.slice(-1),x(r),h(""),t&&e<5&&(null==(s=P.current[e+1])||s.focus()),r.every(e=>""!==e)&&5===e&&O(r.join(""))})(s,e.target.value),onKeyDown:e=>((e,t)=>{var s;"Backspace"===t.key&&!m[e]&&e>0&&(null==(s=P.current[e-1])||s.focus()),"Enter"===t.key&&m.every(e=>""!==e)&&!f&&O(m.join(""))})(s,e),className:"w-11 h-11 text-center text-lg font-semibold focus:outline-none transition-all",style:{color:"#FFFFFF",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",boxShadow:"inset 0 1px 0 rgba(255, 255, 255, 0.1)",WebkitAppearance:"none",MozAppearance:"textfield",appearance:"none"},disabled:f},s))}),p&&e.jsx("p",{className:"text-red-500 text-xs text-center mt-3",children:p}),v&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-yellow-900/20 border border-yellow-700/50",children:[e.jsx("p",{className:"text-yellow-400 text-xs text-center mb-2",children:v}),b&&e.jsxs("div",{className:"mt-2 p-2 rounded bg-black/50 border border-yellow-700/30",children:[e.jsx("p",{className:"text-yellow-300 text-xs text-center mb-1",children:"Development Code:"}),e.jsx("p",{className:"text-white text-lg font-mono text-center font-bold tracking-widest",children:b})]})]}),e.jsxs("div",{className:"text-center text-sm leading-snug pt-2",children:[e.jsx("p",{className:"mb-2",style:{color:"rgba(156, 163, 175, 0.7)"},children:"Didn't get anything?"}),e.jsxs("p",{style:{color:"rgba(156, 163, 175, 0.7)"},children:["Check your spam or"," ",e.jsx("button",{onClick:$,disabled:f,className:"font-medium transition-colors disabled:opacity-50",style:{color:"#FFFFFF"},onMouseEnter:e=>!f&&(e.currentTarget.style.color="#C9CBD1"),onMouseLeave:e=>!f&&(e.currentTarget.style.color="#FFFFFF"),children:"send a new one"}),"."]})]})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center relative overflow-hidden py-8 sm:py-12 px-6",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E\")"},children:[e.jsxs("button",{onClick:()=>B(E?"/learn/artist":"/"),className:"fixed top-6 left-6 z-50 flex items-center gap-1.5 text-gray-400 hover:text-white transition-colors group",children:[e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-xs font-medium",children:E?"Back":"Home"})]}),!k&&e.jsx("div",{className:"absolute inset-0 w-full h-full pointer-events-none transition-opacity duration-700 ease-out overflow-hidden",style:{opacity:j?1:0,transform:"translateX(30%) scale(1.035)"},children:e.jsx("spline-viewer",{url:"https://prod.spline.design/hxB6DGH8u6Rcpq21/scene.splinecode","mouse-controls":"false",className:"spline-viewer-no-watermark"})}),e.jsxs("div",{className:"relative z-10 w-full max-w-sm flex flex-col items-center",children:[e.jsx("div",{className:"w-full flex justify-center mb-6",children:e.jsx("img",{src:"/elevate solid white logo ver.jpeg",alt:"Elevate Logo",className:"h-16 w-auto"})}),e.jsx("h1",{className:"text-2xl font-semibold text-white mb-1",children:F?"Continue your signup":"Sign up for Elevate"}),e.jsx("p",{className:"text-neutral-400 text-sm mb-6",children:F?"Pick up where you left off. We've saved your progress.":e.jsxs(e.Fragment,{children:["Already have an account? ",e.jsx("button",{onClick:()=>B("/login"),className:"text-white font-medium hover:underline",children:"Log in"}),"."]})}),e.jsxs("button",{onClick:()=>{},className:"w-full h-11 bg-transparent border border-neutral-700 text-white hover:bg-neutral-800 rounded-lg mb-6 flex items-center justify-center gap-2 transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign up with Google"]}),e.jsxs("div",{className:"w-full flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex-1 h-px bg-neutral-700"}),e.jsx("span",{className:"text-neutral-500 text-xs",children:"or"}),e.jsx("div",{className:"flex-1 h-px bg-neutral-700"})]}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",id:"signup-email-input",value:l,onChange:e=>{const t=e.target.value;o(t),h(""),c(!t||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))},onKeyDown:e=>{"Enter"===e.key&&l&&i&&!f&&I()},placeholder:" ",className:"peer h-11 w-full px-4 bg-transparent border border-neutral-700 text-white rounded-lg focus:border-neutral-500 focus:outline-none transition-colors"}),e.jsx("label",{htmlFor:"signup-email-input",className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 text-sm pointer-events-none transition-all duration-200 peer-focus:top-0 peer-focus:text-xs peer-focus:bg-black peer-focus:px-1 peer-focus:-translate-y-1/2 peer-[:not(:placeholder-shown)]:top-0 peer-[:not(:placeholder-shown)]:text-xs peer-[:not(:placeholder-shown)]:bg-black peer-[:not(:placeholder-shown)]:px-1 peer-[:not(:placeholder-shown)]:-translate-y-1/2",children:"Email address*"})]}),!i&&e.jsx("p",{className:"text-red-500 text-xs mt-1.5",children:"Please enter a valid email address"}),p&&e.jsx("p",{className:"text-red-500 text-xs mt-1.5",children:p})]}),e.jsx("button",{onClick:I,disabled:!l||!i||f,className:"w-full h-11 rounded-lg mb-6 transition-all duration-300 "+(l&&i?"text-black hover:opacity-95":"bg-neutral-800 text-neutral-500 border border-neutral-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-neutral-800"),style:l&&i?{background:"#E8E8E8"}:{},children:f?"Signing up...":"Sign Up"}),e.jsxs("p",{className:"text-neutral-400 text-xs text-center",children:["By signing up, you agree to our"," ",e.jsx("button",{className:"text-white underline hover:no-underline",children:"Terms"})," ","and"," ",e.jsx("button",{className:"text-white underline hover:no-underline",children:"Privacy Policy"}),"."]})]})]})}export{l as SignupPage};
