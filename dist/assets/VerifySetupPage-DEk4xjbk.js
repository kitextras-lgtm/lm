import{j as e}from"./spline-OfIZ-5GP.js";import{r as s}from"./react-vendor-ClpDbY_3.js";import{s as a}from"./index-FbpD5WL4.js";import"./supabase-Dq2D-Wrk.js";function t(){const[t,i]=s.useState([]),[n,r]=s.useState(!1),c="https://hlcpoqxzqgbghsadouef.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhsY3BvcXh6cWdiZ2hzYWRvdWVmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMzI2MTUsImV4cCI6MjA4MTcwODYxNX0.Qhbzj0g5FbpW0wgtGsJBF2AV0HqL-9X2S2nGL64KCYA",o=(e,s,a,t)=>{i(i=>[...i,{name:e,status:s,message:a,details:t}])},d=e=>{switch(e){case"pass":return"text-green-400";case"fail":return"text-red-400";case"warning":return"text-yellow-400";case"checking":return"text-blue-400";default:return"text-gray-400"}},m=e=>{switch(e){case"pass":return"âœ…";case"fail":return"âŒ";case"warning":return"âš ï¸";case"checking":return"â³";default:return"â—‹"}};return e.jsx("div",{className:"min-h-screen bg-black text-white p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Setup Verification"}),e.jsx("p",{className:"text-gray-400 mb-8",children:"This page verifies your OTP system setup: Edge Functions, Environment Variables, and Database Tables."}),e.jsx("button",{onClick:async()=>{r(!0),i([]),o("Edge Function: send-otp","checking","Checking...");try{const e=await fetch(`${c}/functions/v1/send-otp`,{method:"OPTIONS",headers:{Authorization:`Bearer ${l}`}}),s=e.ok||405===e.status;i(a=>a.map(a=>"Edge Function: send-otp"===a.name?{...a,status:s?"pass":"fail",message:s?"âœ… Accessible":"âŒ Not accessible",details:`Status: ${e.status}`}:a))}catch(e){i(s=>s.map(s=>"Edge Function: send-otp"===s.name?{...s,status:"fail",message:"âŒ Error",details:e.message}:s))}o("Edge Function: verify-otp","checking","Checking...");try{const e=await fetch(`${c}/functions/v1/verify-otp`,{method:"OPTIONS",headers:{Authorization:`Bearer ${l}`}}),s=e.ok||405===e.status;i(a=>a.map(a=>"Edge Function: verify-otp"===a.name?{...a,status:s?"pass":"fail",message:s?"âœ… Accessible":"âŒ Not accessible",details:`Status: ${e.status}`}:a))}catch(e){i(s=>s.map(s=>"Edge Function: verify-otp"===s.name?{...s,status:"fail",message:"âŒ Error",details:e.message}:s))}o("VITE_SUPABASE_URL","pass","âœ… Configured","Environment variable is set"),o("VITE_SUPABASE_ANON_KEY","pass","âœ… Configured","Environment variable is set"),o("Backend Secrets (RESEND_API_KEY, FROM_EMAIL)","warning","âš ï¸ Cannot verify from frontend","Please check in Supabase Dashboard â†’ Edge Functions â†’ Settings â†’ Secrets"),o("users table","checking","Checking...");try{const{error:e}=await a.from("users").select("id").limit(1);i(s=>s.map(s=>"users table"===s.name?{...s,status:e?"fail":"pass",message:e?"âŒ Not accessible":"âœ… Accessible",details:null==e?void 0:e.message}:s))}catch(e){i(s=>s.map(s=>"users table"===s.name?{...s,status:"fail",message:"âŒ Error",details:e.message}:s))}o("otp_codes table","checking","Checking...");try{const{error:e}=await a.from("otp_codes").select("id").limit(1);i(s=>s.map(s=>"otp_codes table"===s.name?{...s,status:e?"fail":"pass",message:e?"âŒ Not accessible":"âœ… Accessible",details:null==e?void 0:e.message}:s))}catch(e){i(s=>s.map(s=>"otp_codes table"===s.name?{...s,status:"fail",message:"âŒ Error",details:e.message}:s))}o("send-otp endpoint test","checking","Testing...");try{const e=await fetch(`${c}/functions/v1/send-otp`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({email:"test@example.com",isSignup:!0})}),s=await e.json();i(a=>a.map(a=>"send-otp endpoint test"===a.name?{...a,status:e.ok&&void 0!==s.success?"pass":"fail",message:e.ok&&void 0!==s.success?"âœ… Working":"âŒ Error",details:s.message||`Status: ${e.status}`}:a))}catch(e){i(s=>s.map(s=>"send-otp endpoint test"===s.name?{...s,status:"fail",message:"âŒ Request failed",details:e.message}:s))}r(!1)},disabled:n,className:"mb-8 px-6 py-3 bg-white text-black rounded-lg font-semibold hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Running Checks...":"Run Verification"}),t.length>0&&e.jsx("div",{className:"space-y-4",children:t.map((s,a)=>e.jsxs("div",{className:"p-4 rounded-lg border border-gray-800 bg-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-xl",children:m(s.status)}),e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx("span",{className:d(s.status),children:s.message})]}),s.details&&e.jsx("p",{className:"text-sm text-gray-400 ml-8",children:s.details})]},a))}),t.length>0&&!n&&e.jsxs("div",{className:"mt-8 p-6 rounded-lg border border-gray-800 bg-gray-900",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:["âœ… Passed: ",t.filter(e=>"pass"===e.status).length]}),e.jsxs("p",{children:["âŒ Failed: ",t.filter(e=>"fail"===e.status).length]}),e.jsxs("p",{children:["âš ï¸ Warnings: ",t.filter(e=>"warning"===e.status).length]})]}),0===t.filter(e=>"fail"===e.status).length&&e.jsx("p",{className:"mt-4 text-green-400",children:"ðŸŽ‰ All critical checks passed!"})]}),e.jsxs("div",{className:"mt-8 p-6 rounded-lg border border-gray-800 bg-gray-900",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Manual Verification Steps"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-400",children:[e.jsx("li",{children:"Check Supabase Dashboard â†’ Edge Functions â†’ verify both functions are deployed"}),e.jsx("li",{children:"Check Supabase Dashboard â†’ Edge Functions â†’ Settings â†’ Secrets â†’ verify RESEND_API_KEY and FROM_EMAIL are set"}),e.jsx("li",{children:"Test signup flow with a real email address"})]})]})]})})}export{t as VerifySetupPage};
