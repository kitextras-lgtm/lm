const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-Cd5aNKwr.js","assets/spline-DN92G9fQ.js","assets/react-vendor-C5CBPnGl.js","assets/createLucideIcon-DApH4y_Q.js","assets/plus-huPEdIgT.js","assets/SignupPage-DiuF_rqN.js","assets/supabase-CAOwvaCC.js","assets/LoginPage-v_ZLwDPr.js","assets/UserTypeSelectionPage-oLlbZKSV.js","assets/MakeProfilePage-CBLen5Ct.js","assets/TellUsAboutYourselfPage-D8ENzjhJ.js","assets/ContactForm-D_Zmr_aC.js","assets/chevron-down-BtUUkoj_.js","assets/ArtistDashboard-D2n0bKB9.js","assets/SettingsView-CPJGhLH0.js","assets/debounce-DXkVv9wN.js","assets/arrow-left-D6ZoFILw.js","assets/map-pin-D8GFr4Pd.js","assets/DoorTransition-qwGU0lrz.js","assets/CreatorDashboard-DFB3US-2.js","assets/BusinessDashboard-DQ-6Jn2e.js","assets/MobileMenuPage-Bwwb7oHr.js","assets/SettingsPage-shedWVDj.js","assets/VerifySetupPage-B2XlfWZ6.js","assets/AdminLoginPage-CHlV_UU7.js","assets/AdminDashboard-ItnqLVz0.js"])))=>i.map(i=>d[i]);
import{j as e,_ as t}from"./spline-DN92G9fQ.js";import{a as r,r as s,N as a,B as n,R as i,b as o}from"./react-vendor-C5CBPnGl.js";import{c as l}from"./supabase-CAOwvaCC.js";var c;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var u=r;c=u.createRoot,u.hydrateRoot;const d="https://hlcpoqxzqgbghsadouef.supabase.co",f="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhsY3BvcXh6cWdiZ2hzYWRvdWVmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMzI2MTUsImV4cCI6MjA4MTcwODYxNX0.Qhbzj0g5FbpW0wgtGsJBF2AV0HqL-9X2S2nGL64KCYA",m=l(d,f);function p({text:t="Loading...",barCount:r=5,className:s=""}){return e.jsxs("div",{className:`flex flex-col items-center justify-center ${s}`,children:[e.jsx("div",{className:"flex items-end gap-1.5 mb-4",children:Array.from({length:r}).map((t,r)=>e.jsx("div",{className:"w-1.5 rounded-full animate-bar",style:{backgroundColor:"#F8FAFC",height:"32px",animationDelay:.05*r+"s"}},r))}),t&&e.jsx("p",{className:"text-sm",style:{color:"#64748B"},children:t})]})}function h({children:t}){const[r,n]=s.useState(null),[i,o]=s.useState(!0);return s.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("verifiedUserId"),t=localStorage.getItem("verifiedEmail");if(e)return n(!0),void o(!1);if(t){const{data:{user:e}}=await m.auth.getUser();if(e)n(!0);else{const{data:e}=await m.from("users").select("id").eq("email",t).maybeSingle();(null==e?void 0:e.id)?(localStorage.setItem("verifiedUserId",e.id),n(!0)):n(!1)}}else{const{data:{session:e}}=await m.auth.getSession();n(!!e)}}catch(e){n(!1)}finally{o(!1)}})()},[]),i?e.jsx("div",{style:{backgroundColor:"#000",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff"},children:e.jsx(p,{text:"Loading..."})}):r?t:e.jsx(a,{to:"/login",replace:!0})}const g=s.createContext(void 0);function _({children:t}){const[r,a]=s.useState(null),[n,i]=s.useState(null),[o,l]=s.useState(!0),c=s.useRef(null);s.useEffect(()=>{l(!1)},[]);const u=async()=>{try{const e=c.current||n;if(!e)return l(!1),!1;const t=await fetch(`${d}/functions/v1/admin-verify-session`,{method:"GET",headers:{Authorization:`Bearer ${f}`,"X-Session-Token":e,"Content-Type":"application/json"}}),r=await t.json();return r.success&&r.admin?(a(r.admin),c.current=e,l(!1),!0):(a(null),i(null),c.current=null,l(!1),!1)}catch(e){return a(null),i(null),c.current=null,l(!1),!1}},m={admin:r,sessionToken:c.current||n,isLoading:o,isAuthenticated:!!r,login:async(e,t,r)=>{try{const s=await fetch(`${d}/functions/v1/admin-login`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({email:e,password:t,totpCode:r})});if(!s.ok){await s.text();return{success:!1,message:`Server error: ${s.status}`}}const n=await s.text();if(!n)return{success:!1,message:"Empty response from server"};const o=JSON.parse(n);return o.success&&o.sessionToken&&o.admin?(c.current=o.sessionToken,i(o.sessionToken),a(o.admin),{success:!0}):{success:!1,message:o.message||"Login failed",requiresTotp:o.requiresTotp||!1}}catch(s){return{success:!1,message:s.message||"Login failed"}}},logout:async()=>{try{n&&await fetch(`${d}/functions/v1/admin-logout`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"X-Session-Token":n,"Content-Type":"application/json"}})}catch(e){}finally{a(null),i(null),c.current=null}},verifySession:u,hasPermission:(e,t)=>{if(!r||!r.permissions)return!1;const s=r.permissions[e];return!(!s||!Array.isArray(s))&&s.includes(t)},refreshSession:async()=>{await u()}};return e.jsx(g.Provider,{value:m,children:t})}function y(){const e=s.useContext(g);if(void 0===e)throw new Error("useAdminAuth must be used within an AdminAuthProvider");return e}const x="user_profile_cache";function j(e){if(!e)return null;try{const t=localStorage.getItem(x);if(!t)return null;const r=JSON.parse(t);return"1"!==r.version||r.userId!==e?null:r.profile}catch(t){return null}}function b(e,t){if(e&&t)try{const r={profile:t,userId:e,timestamp:Date.now(),version:"1"};localStorage.setItem(x,JSON.stringify(r))}catch(r){}}const v="avatar_cache_";function S(e){try{const t=localStorage.getItem(v+e);if(t){const{data:e,version:r}=JSON.parse(t);if("1"===r)return e}}catch(t){}return null}async function I(e){try{if(S(e))return;const t=await async function(e){try{const t=await fetch(e,{mode:"cors"}),r=await t.blob();return new Promise((e,t)=>{const s=new FileReader;s.onloadend=()=>e(s.result),s.onerror=t,s.readAsDataURL(r)})}catch(t){return null}}(e);t&&localStorage.setItem(v+e,JSON.stringify({data:t,version:"1",timestamp:Date.now()}))}catch(t){}}function P(e){if(!e)return;if(S(e))return;const t=new Image;t.crossOrigin="anonymous",t.loading="eager",t.fetchPriority="high",t.onload=()=>{I(e).catch(()=>{})},t.onerror=()=>{},t.src=e}const w=Object.freeze(Object.defineProperty({__proto__:null,cacheImage:I,getCachedImage:S,preloadAndCacheImage:P},Symbol.toStringTag,{value:"Module"})),E=s.createContext(void 0);function A({children:t}){const[r,a]=s.useState(null),[n,i]=s.useState(null),[o,l]=s.useState(!0),[c,u]=s.useState(!1),[p,h]=s.useState(null),g=s.useCallback(async e=>{try{const t=`${d}/functions/v1/get-profile?userId=${e}`,r=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(r.ok){const e=await r.json();if(e.success&&e.user){const t=e.user;return{id:t.id,email:t.email||"",first_name:t.first_name||"",last_name:t.last_name||"",username:t.username||"",profile_picture_url:t.profile_picture_url||null,location:t.location||"",primary_language:t.primary_language||"English",user_type:t.user_type||"",created_at:t.created_at||"",updated_at:t.updated_at||(new Date).toISOString()}}}const{data:s,error:a}=await m.from("users").select("*").eq("id",e).maybeSingle();if(a)return null;if(s){return{id:s.id,email:s.email||"",first_name:s.first_name||"",last_name:s.last_name||"",username:s.username||"",profile_picture_url:s.profile_picture_url||null,location:s.location||"",primary_language:s.primary_language||"English",user_type:s.user_type||"",created_at:s.created_at||"",updated_at:s.updated_at||(new Date).toISOString()}}return null}catch(t){return null}},[]),_=s.useCallback(async()=>{try{const{data:{user:e}}=await m.auth.getUser(),t=localStorage.getItem("verifiedUserId"),r=localStorage.getItem("verifiedEmail");let s=(null==e?void 0:e.id)||t;if(!s&&r){const{data:e}=await m.from("users").select("id").eq("email",r).maybeSingle();(null==e?void 0:e.id)&&(s=e.id,localStorage.setItem("verifiedUserId",s))}if(!s)return void l(!1);i(s);const n=j(s);if(n){a(n),l(!1),n.profile_picture_url&&"string"==typeof n.profile_picture_url&&P(n.profile_picture_url),u(!0);const e=await g(s);e&&JSON.stringify(e)!==JSON.stringify(n)&&(a(e),b(s,e),e.profile_picture_url&&e.profile_picture_url!==n.profile_picture_url&&P(e.profile_picture_url)),u(!1)}else{const e=await g(s);e&&(a(e),b(s,e),e.profile_picture_url&&P(e.profile_picture_url)),l(!1)}}catch(e){h("Failed to load profile"),l(!1)}},[g]),y=s.useCallback(async()=>{if(!n)return;u(!0),h(null);const e=await g(n);e?(a(e),b(n,e)):h("Failed to refresh profile"),u(!1)},[n,g]),v=s.useCallback(e=>{if(!n||!r)return;const t={...r,...e,updated_at:(new Date).toISOString()};a(t),function(e,t){const r=j(e);if(!r)return;b(e,{...r,...t,updated_at:(new Date).toISOString()})}(n,e)},[n,r]),S=s.useCallback(()=>{!function(){try{localStorage.removeItem(x)}catch(p){}}(),a(null),i(null)},[]),I=s.useCallback(async e=>{const t=await g(e);return t&&(b(e,t),a(t),i(e),t.profile_picture_url&&P(t.profile_picture_url)),t},[g]);s.useEffect(()=>{_()},[_]),s.useEffect(()=>{const{data:{subscription:e}}=m.auth.onAuthStateChange((e,t)=>{var r;"SIGNED_OUT"===e?S():"SIGNED_IN"===e&&(null==(r=null==t?void 0:t.user)?void 0:r.id)&&I(t.user.id)});return()=>{e.unsubscribe()}},[S,I]),s.useEffect(()=>{const e=()=>{!document.hidden&&n&&y()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[n,y]);const w={profile:r,userId:n,isLoading:o,isRefreshing:c,error:p,refetch:y,updateProfile:v,clearCache:S,prefetchProfile:I};return e.jsx(E.Provider,{value:w,children:t})}function T(){const e=s.useContext(E);if(void 0===e)throw new Error("useUserProfile must be used within a UserProfileProvider");return e}function L({children:t,requiredPermission:r}){const{isAuthenticated:s,isLoading:n,hasPermission:i}=y();return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#111111"},children:e.jsx(p,{text:"Loading dashboard..."})}):s?r&&!i(r.resource,r.action)?e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#111111"},children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-400",children:"You don't have permission to access this page."})]})}):e.jsx(e.Fragment,{children:t}):e.jsx(a,{to:"/admin/login",replace:!0})}function O(){return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{backgroundColor:"#000000"},children:e.jsxs("div",{className:"relative",style:{width:"100px",height:"100px"},children:[e.jsx("div",{className:"absolute rounded-full",style:{width:"100px",height:"100px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"radial-gradient(circle, rgba(255, 255, 255, 0.06) 0%, transparent 70%)",animation:"premium-pulse 2.5s ease-in-out infinite"}}),e.jsx("div",{className:"absolute rounded-full",style:{width:"70px",height:"70px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"radial-gradient(circle, rgba(255, 255, 255, 0.04) 0%, transparent 70%)",animation:"premium-pulse 2.5s ease-in-out infinite 0.4s"}}),e.jsx("div",{className:"absolute rounded-full",style:{width:"40px",height:"40px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"radial-gradient(circle, rgba(255, 255, 255, 0.08) 0%, transparent 60%)",animation:"premium-pulse 2.5s ease-in-out infinite 0.8s"}}),e.jsx("div",{className:"absolute rounded-full",style:{width:"3px",height:"3px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(255, 255, 255, 0.5)",boxShadow:"0 0 6px rgba(255, 255, 255, 0.2)"}})]})})}const C=s.lazy(()=>t(()=>import("./HomePage-Cd5aNKwr.js"),__vite__mapDeps([0,1,2,3,4])).then(e=>({default:e.HomePage}))),D=s.lazy(()=>t(()=>import("./SignupPage-DiuF_rqN.js"),__vite__mapDeps([5,1,2,6])).then(e=>({default:e.SignupPage}))),N=s.lazy(()=>t(()=>import("./LoginPage-v_ZLwDPr.js"),__vite__mapDeps([7,1,2,6])).then(e=>({default:e.LoginPage}))),k=s.lazy(()=>t(()=>import("./UserTypeSelectionPage-oLlbZKSV.js"),__vite__mapDeps([8,1,2,6])).then(e=>({default:e.UserTypeSelectionPage}))),z=s.lazy(()=>t(()=>import("./MakeProfilePage-CBLen5Ct.js"),__vite__mapDeps([9,1,2,6])).then(e=>({default:e.MakeProfilePage}))),R=s.lazy(()=>t(()=>import("./TellUsAboutYourselfPage-D8ENzjhJ.js"),__vite__mapDeps([10,1,2,6])).then(e=>({default:e.TellUsAboutYourselfPage}))),V=s.lazy(()=>t(()=>import("./ContactForm-D_Zmr_aC.js"),__vite__mapDeps([11,1,2,3,12])).then(e=>({default:e.ContactForm}))),J=s.lazy(()=>t(()=>import("./ArtistDashboard-D2n0bKB9.js"),__vite__mapDeps([13,1,2,14,3,15,16,12,4,17,18,6])).then(e=>({default:e.ArtistDashboard}))),U=s.lazy(()=>t(()=>import("./CreatorDashboard-DFB3US-2.js"),__vite__mapDeps([19,1,2,14,3,15,16,12,4,17,18,6])).then(e=>({default:e.CreatorDashboard}))),M=s.lazy(()=>t(()=>import("./BusinessDashboard-DQ-6Jn2e.js"),__vite__mapDeps([20,1,2,18])).then(e=>({default:e.BusinessDashboard}))),F=s.lazy(()=>t(()=>import("./MobileMenuPage-Bwwb7oHr.js"),__vite__mapDeps([21,1,2])).then(e=>({default:e.MobileMenuPage}))),B=s.lazy(()=>t(()=>import("./SettingsPage-shedWVDj.js"),__vite__mapDeps([22,1,2,16,3,17,6])).then(e=>({default:e.SettingsPage}))),$=s.lazy(()=>t(()=>import("./VerifySetupPage-B2XlfWZ6.js"),__vite__mapDeps([23,1,2,6])).then(e=>({default:e.VerifySetupPage}))),q=s.lazy(()=>t(()=>import("./AdminLoginPage-CHlV_UU7.js"),__vite__mapDeps([24,1,2,6])).then(e=>({default:e.AdminLoginPage}))),Y=s.lazy(()=>t(()=>import("./AdminDashboard-ItnqLVz0.js"),__vite__mapDeps([25,1,2,15,3,16,12,6])).then(e=>({default:e.AdminDashboard})));function X(){return e.jsx(A,{children:e.jsx(_,{children:e.jsx(n,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(s.Suspense,{fallback:e.jsx(O,{}),children:e.jsxs(i,{children:[e.jsx(o,{path:"/",element:e.jsx(C,{})}),e.jsx(o,{path:"/menu",element:e.jsx(F,{})}),e.jsx(o,{path:"/signup",element:e.jsx(D,{})}),e.jsx(o,{path:"/login",element:e.jsx(N,{})}),e.jsx(o,{path:"/user-type-selection",element:e.jsx(k,{})}),e.jsx(o,{path:"/make-profile",element:e.jsx(z,{})}),e.jsx(o,{path:"/tell-us-about-yourself",element:e.jsx(R,{})}),e.jsx(o,{path:"/contact",element:e.jsx(V,{})}),e.jsx(o,{path:"/dashboard/artist",element:e.jsx(h,{children:e.jsx(J,{})})}),e.jsx(o,{path:"/dashboard/creator",element:e.jsx(h,{children:e.jsx(U,{})})}),e.jsx(o,{path:"/dashboard/business",element:e.jsx(h,{children:e.jsx(M,{})})}),e.jsx(o,{path:"/settings",element:e.jsx(h,{children:e.jsx(B,{})})}),e.jsx(o,{path:"/verify-setup",element:e.jsx($,{})}),e.jsx(o,{path:"/admin/login",element:e.jsx(q,{})}),e.jsx(o,{path:"/admin/dashboard",element:e.jsx(L,{children:e.jsx(Y,{})})})]})})})})})}document.body.classList.add("preload"),window.addEventListener("load",()=>{setTimeout(()=>{document.body.classList.remove("preload")},100)});const G=document.getElementById("root");if(!G)throw new Error("Root element not found");c(G).render(e.jsx(s.StrictMode,{children:e.jsx(X,{})}));export{p as A,d as S,f as a,y as b,S as g,w as i,P as p,m as s,T as u};
